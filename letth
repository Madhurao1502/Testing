<h3>Paste Excel Numbers</h3>
<textarea
  rows="10"
  cols="40"
  (paste)="onPaste($event)"
  placeholder="Paste your numbers here">
</textarea>

<p *ngIf="numbers.length">Total Numbers: {{ numbers.length }}</p>

<button (click)="sendToApi()">Send to API</button>


import { Component } from '@angular/core';
import { HttpClient } from '@angular/common/http';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html'
})
export class AppComponent {
  numbers: string[] = [];

  constructor(private http: HttpClient) {}

  onPaste(event: ClipboardEvent): void {
    event.preventDefault();
    const clipboardData = event.clipboardData?.getData('text') || '';
    this.numbers = clipboardData
      .split(/\r?\n/)
      .map(val => val.trim())
      .filter(val => val !== '');
  }

  sendToApi(): void {
    const payload = { numbers: this.numbers };

    this.http.post('https://localhost:5001/api/values', payload)
      .subscribe({
        next: res => console.log('Success:', res),
        error: err => console.error('Error:', err)
      });
  }
}

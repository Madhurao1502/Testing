onSelectionChange(event: any, element: any) {
  const control = this.attrFormGroup.get("control_" + element.AttributeName);
  const currentValue: any[] = Array.isArray(control?.value) ? control.value : [];

  // Add or remove from currentValue depending on the event
  if (event.isUserInput) {
    const selectedValue = event.source.value;
    const index = currentValue.indexOf(selectedValue);

    if (event.source.selected) {
      // Only add if not already present
      if (index === -1) {
        currentValue.push(selectedValue);
      }
    } else {
      // Remove unchecked value
      if (index !== -1) {
        currentValue.splice(index, 1);
      }
    }

    control?.setValue(currentValue); // âœ… Patch updated value
  }
}

import { Directive, ElementRef, HostListener } from '@angular/core';

@Directive({
  selector: '[appCurrencyFormatter]'
})
export class CurrencyFormatterDirective {
  constructor(private el: ElementRef) {}

  @HostListener('input', ['$event'])
  onInputChange(event: Event) {
    let input = (event.target as HTMLInputElement).value;

    // Remove alphabets and keep only numbers, dot, and commas
    input = input.replace(/[^0-9.]/g, '');

    // Format with commas
    let parts = input.split('.');
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    input = parts.join('.');

    // Ensure the value starts with `$`
    this.el.nativeElement.value = `$` + input;
  }
}

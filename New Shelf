public string GetcurrentweekGridData(GetGridDataFilter filter)
{
    string rst = "";
    DataTable dt = new DataTable();
    List<CurrentWeekDataModel> _gdmGrid = new List<CurrentWeekDataModel>();
    try
    {


        using SqlConnection conn = new();
        conn.ConnectionString = _sqlConnString;
        conn.Open();
        SqlCommand cmd = new("USP_get_assignments_current_week", conn) { CommandType = CommandType.StoredProcedure };
        cmd.CommandTimeout = 180;
        cmd.Parameters.Add(new SqlParameter("@iri_week", filter.IriWeek));
        //cmd.Parameters.Add(new SqlParameter("@area_nbr", filter.Area));
        cmd.Parameters.Add(new SqlParameter("@territory", filter.TerritoryId));
        //cmd.Parameters.Add(new SqlParameter("@store_number", string.IsNullOrEmpty(filter.StoreNumber) ? DBNull.Value : filter.StoreNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_id", string.IsNullOrEmpty(filter.EmpId) ? DBNull.Value : filter.EmpId));
        //cmd.Parameters.Add(new SqlParameter("@task_number", string.IsNullOrEmpty(filter.TaskNumber) ? DBNull.Value : filter.TaskNumber));
        //cmd.Parameters.Add(new SqlParameter("@store_state", string.IsNullOrEmpty(filter.State) ? DBNull.Value : filter.State));
        //cmd.Parameters.Add(new SqlParameter("@store_city", string.IsNullOrEmpty(filter.City) ? DBNull.Value : filter.City));
        //cmd.Parameters.Add(new SqlParameter("@position_number", string.IsNullOrEmpty(filter.PositionNumber) ? DBNull.Value : filter.PositionNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour_operator", filter.FsrHourOperator));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour", filter.FsrHour));
        //cmd.Parameters.Add(new SqlParameter("@assigned_stores", filter.AssignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@unassigned_stores", filter.UnassignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@sample_stores", filter.Sample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@non_sample_stores", filter.NonSample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@multi_fsr_stores", filter.MultiFsrStore == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@vacation", filter.Vacation == "false" ? false : true));
        cmd.Parameters.Add(new SqlParameter("@country_id", filter.CountryId));
        // cmd.Parameters.Add(new SqlParameter("@temporary", filter.Temporary == "false" ? false : true));


        using (SqlDataAdapter sda = new(cmd))
        {
            sda.Fill(dt);
        }
        conn.Close();


        if (dt != null && dt.Rows.Count > 0)
        {
            foreach (DataRow dr in dt.Rows)
            {
                CurrentWeekDataModel _gdm = new CurrentWeekDataModel();


                _gdm.IriWeek = dr["iri_week"].ToString();
                _gdm.PositionName = dr["position_name"].ToString();
                _gdm.Bfd = dr["bfd"].ToString();
                _gdm.OutletType = dr["outlet_type"].ToString();
                _gdm.StoreNumber = dr["store_number"].ToString();
                _gdm.StoreName = dr["store_name"].ToString();
                _gdm.AddrLine1 = dr["addr_line1"].ToString();
                _gdm.CityName = dr["city_name"].ToString();
                _gdm.StateCd = dr["state_cd"].ToString();
                _gdm.ZipCd = dr["zip_cd"].ToString();
                _gdm.EmpId = dr["emp_id"].ToString();
                _gdm.FirstName = dr["first_name"].ToString();
                _gdm.LastName = dr["last_name"].ToString();
                _gdm.TaskNumber = dr["task_number"].ToString();
                _gdm.TaskCompleted = dr["task_completed"].ToString();
                _gdm.Quality = dr["quality"].ToString();
                _gdm.CostOver = dr["cost_over"].ToString();
                _gdm.GuaranteedMiles = dr["guaranteed_miles"].ToString();

                _gdmGrid.Add(_gdm);
            }
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }

    var gridList = _gdmGrid.ToList();
    rst = JsonConvert.SerializeObject(gridList);
    return rst;
}


public string GetfutureweekGridData(GetGridDataFilter filter)
{
    string rst = "";
    DataTable dt = new DataTable();
    List<FutureWeekDataModel> _gdmGrid = new List<FutureWeekDataModel>();
    try
    {


        using SqlConnection conn = new();
        conn.ConnectionString = _sqlConnString;
        conn.Open();
        SqlCommand cmd = new("USP_get_assignments", conn) { CommandType = CommandType.StoredProcedure };
        cmd.CommandTimeout = 180;
        cmd.Parameters.Add(new SqlParameter("@iri_week", filter.IriWeek));
        //cmd.Parameters.Add(new SqlParameter("@area_nbr", filter.Area));
        cmd.Parameters.Add(new SqlParameter("@territory", filter.TerritoryId));
        //cmd.Parameters.Add(new SqlParameter("@store_number", string.IsNullOrEmpty(filter.StoreNumber) ? DBNull.Value : filter.StoreNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_id", string.IsNullOrEmpty(filter.EmpId) ? DBNull.Value : filter.EmpId));
        //cmd.Parameters.Add(new SqlParameter("@task_number", string.IsNullOrEmpty(filter.TaskNumber) ? DBNull.Value : filter.TaskNumber));
        //cmd.Parameters.Add(new SqlParameter("@store_state", string.IsNullOrEmpty(filter.State) ? DBNull.Value : filter.State));
        //cmd.Parameters.Add(new SqlParameter("@store_city", string.IsNullOrEmpty(filter.City) ? DBNull.Value : filter.City));
        //cmd.Parameters.Add(new SqlParameter("@position_number", string.IsNullOrEmpty(filter.PositionNumber) ? DBNull.Value : filter.PositionNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour_operator", filter.FsrHourOperator));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour", filter.FsrHour));
        //cmd.Parameters.Add(new SqlParameter("@assigned_stores", filter.AssignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@unassigned_stores", filter.UnassignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@sample_stores", filter.Sample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@non_sample_stores", filter.NonSample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@multi_fsr_stores", filter.MultiFsrStore == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@vacation", filter.Vacation == "false" ? false : true));
        cmd.Parameters.Add(new SqlParameter("@country_id", filter.CountryId));
        // cmd.Parameters.Add(new SqlParameter("@temporary", filter.Temporary == "false" ? false : true));


        using (SqlDataAdapter sda = new(cmd))
        {
            sda.Fill(dt);
        }
        conn.Close();


        if (dt != null && dt.Rows.Count > 0)
        {
            foreach (DataRow dr in dt.Rows)
            {
                FutureWeekDataModel _gdm = new FutureWeekDataModel();



                _gdm.IriWeek = dr["iri_week"].ToString();
                _gdm.FldTerrtyNbr = dr["fld_terrty_nbr"].ToString();
                _gdm.PositionName = dr["position_name"].ToString();
                _gdm.Bfd = dr["bfd"].ToString();
                _gdm.OutletType = dr["outlet_type"].ToString();
                _gdm.StoreNumber = dr["store_number"].ToString();
                _gdm.StoreName = dr["store_name"].ToString();
                _gdm.AddrLine1 = dr["addr_line1"].ToString();
                _gdm.CityName = dr["city_name"].ToString();
                _gdm.StateCd = dr["state_cd"].ToString();
                _gdm.ZipCd = dr["zip_cd"].ToString();
                _gdm.EmpId = dr["emp_id"].ToString();
                _gdm.FirstName = dr["first_name"].ToString();
                _gdm.LastName = dr["last_name"].ToString();
                _gdm.TaskNumber = dr["task_number"].ToString();
                _gdm.AvgCost = dr["avg_cost"].ToString();
                _gdm.GuaranteedMiles = dr["guaranteed_miles"].ToString();


                _gdmGrid.Add(_gdm);
            }
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }

    var gridList = _gdmGrid.ToList();
    rst = JsonConvert.SerializeObject(gridList);
    return rst;
}


public string GetpreviousweekGridData(GetGridDataFilter filter)
{
    string rst = "";
    DataTable dt = new DataTable();
    List<PreviousWeekDataModel> _gdmGrid = new List<PreviousWeekDataModel>();
    try
    {


        using SqlConnection conn = new();
        conn.ConnectionString = _sqlConnString;
        conn.Open();
        SqlCommand cmd = new("USP_get_assignments_previous_weeks", conn) { CommandType = CommandType.StoredProcedure };
        cmd.CommandTimeout = 180;
        cmd.Parameters.Add(new SqlParameter("@iri_week", filter.IriWeek));
        //cmd.Parameters.Add(new SqlParameter("@area_nbr", filter.Area));
        cmd.Parameters.Add(new SqlParameter("@territory", filter.TerritoryId));
        //cmd.Parameters.Add(new SqlParameter("@store_number", string.IsNullOrEmpty(filter.StoreNumber) ? DBNull.Value : filter.StoreNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_id", string.IsNullOrEmpty(filter.EmpId) ? DBNull.Value : filter.EmpId));
        //cmd.Parameters.Add(new SqlParameter("@task_number", string.IsNullOrEmpty(filter.TaskNumber) ? DBNull.Value : filter.TaskNumber));
        //cmd.Parameters.Add(new SqlParameter("@store_state", string.IsNullOrEmpty(filter.State) ? DBNull.Value : filter.State));
        //cmd.Parameters.Add(new SqlParameter("@store_city", string.IsNullOrEmpty(filter.City) ? DBNull.Value : filter.City));
        //cmd.Parameters.Add(new SqlParameter("@position_number", string.IsNullOrEmpty(filter.PositionNumber) ? DBNull.Value : filter.PositionNumber));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour_operator", filter.FsrHourOperator));
        //cmd.Parameters.Add(new SqlParameter("@fsr_hour", filter.FsrHour));
        //cmd.Parameters.Add(new SqlParameter("@assigned_stores", filter.AssignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@unassigned_stores", filter.UnassignedStores == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@sample_stores", filter.Sample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@non_sample_stores", filter.NonSample == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@multi_fsr_stores", filter.MultiFsrStore == "false" ? false : true));
        //cmd.Parameters.Add(new SqlParameter("@vacation", filter.Vacation == "false" ? false : true));
        cmd.Parameters.Add(new SqlParameter("@country_id", filter.CountryId));
        // cmd.Parameters.Add(new SqlParameter("@temporary", filter.Temporary == "false" ? false : true));


        using (SqlDataAdapter sda = new(cmd))
        {
            sda.Fill(dt);
        }
        conn.Close();


        if (dt != null && dt.Rows.Count > 0)
        {
            foreach (DataRow dr in dt.Rows)
            {
                PreviousWeekDataModel _gdm = new PreviousWeekDataModel();




                _gdm.IriWeek = dr["iri_week"].ToString();
                _gdm.FldTerrtyNbr = dr["fld_terrty_nbr"].ToString();
                _gdm.PositionName = dr["position_name"].ToString();
                _gdm.Bfd = dr["bfd"].ToString();
                _gdm.OutletType = dr["outlet_type"].ToString();
                _gdm.StoreNumber = dr["store_number"].ToString();
                _gdm.StoreName = dr["store_name"].ToString();
                _gdm.AddrLine1 = dr["addr_line1"].ToString();
                _gdm.CityName = dr["city_name"].ToString();
                _gdm.StateCd = dr["state_cd"].ToString();
                _gdm.ZipCd = dr["zip_cd"].ToString();
                _gdm.EmpId = dr["emp_id"].ToString();
                _gdm.FirstName = dr["first_name"].ToString();
                _gdm.LastName = dr["last_name"].ToString();
                _gdm.TaskNumber = dr["task_number"].ToString();
                _gdm.TaskCompleted = dr["task_completed"].ToString();
                _gdm.Quality = dr["quality"].ToString();
                _gdm.CostOver = dr["cost_over"].ToString();
                _gdm.WK1FSRProdCost = dr["WK1FSRProdCost"].ToString();
                _gdm.WK1FSRProdCost = dr["WK1FSRProdCost"].ToString();
                _gdm.WK1FSRProdCost = dr["WK1FSRProdCost"].ToString();
                _gdm.WK1StoreTravelCost = dr["WK1StoreTravelCost"].ToString();
                _gdm.WK1StoreTravelOvgCost = dr["WK1StoreTravelOvgCost"].ToString();
                _gdm.WK2FSRProdCost = dr["WK2FSRProdCost"].ToString();
                _gdm.WK2StoreTravelCost = dr["WK2StoreTravelCost"].ToString();
                _gdm.WK2StoreTravelOvgCost = dr["WK2StoreTravelOvgCost"].ToString();



                _gdmGrid.Add(_gdm);
            }
        }
    }
    catch (Exception ex)
    {
        throw ex;
    }

    var gridList = _gdmGrid.ToList();
    rst = JsonConvert.SerializeObject(gridList);
    return rst;
}

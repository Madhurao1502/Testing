<div class="shelf-wrapper">
  <div class="tree-panel">
    <h3>{{ title }}</h3>

    <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
      <!-- Leaf node -->
      <mat-tree-node *matTreeNodeDef="let node">
        <div
          class="node-line"
          [ngStyle]="{ 'padding-left.px': (node.level || 0) * 20 }"
          (click)="onSelect(node)"
        >
          <button mat-icon-button disabled></button>
          <mat-icon class="node-icon">insert_drive_file</mat-icon>
          {{ node.name }}
        </div>
      </mat-tree-node>

      <!-- Expandable node -->
      <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
        <div
          class="node-line"
          [ngStyle]="{ 'padding-left.px': (node.level || 0) * 20 }"
          (click)="onSelect(node)"
        >
          <button mat-icon-button matTreeNodeToggle>
            <mat-icon>
              {{ treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right' }}
            </mat-icon>
          </button>
          <mat-icon class="node-icon">folder</mat-icon>
          {{ node.name }}
        </div>
        <div *ngIf="treeControl.isExpanded(node)">
          <ng-container matTreeNodeOutlet></ng-container>
        </div>
      </mat-nested-tree-node>
    </mat-tree>
  </div>

  <div *ngIf="selectedNode && (showLimits || showChecks)" class="form-panel">
    <h4>Checks / Limits</h4>

    <div *ngIf="showLimits" class="form-section">
      <mat-form-field appearance="outline">
        <mat-label>Min</mat-label>
        <input matInput [(ngModel)]="selectedNode.mainMin"
               (change)="updateValue('min', selectedNode.mainMin)" [disabled]="disableMinMax" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Max</mat-label>
        <input matInput [(ngModel)]="selectedNode.mainMax"
               (change)="updateValue('max', selectedNode.mainMax)" [disabled]="disableMinMax" />
      </mat-form-field>
    </div>

    <div *ngIf="showChecks" class="form-section">
      <mat-form-field appearance="outline">
        <mat-label>Soft</mat-label>
        <input matInput [(ngModel)]="selectedNode.main_soft_check"
               (change)="updateValue('soft', selectedNode.main_soft_check)" />
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Hard</mat-label>
        <input matInput [(ngModel)]="selectedNode.main_hard_check"
               (change)="updateValue('hard', selectedNode.main_hard_check)" />
      </mat-form-field>
    </div>
  </div>
</div>


.shelf-wrapper {
  display: flex;
  flex-direction: row;
  gap: 24px;
  align-items: flex-start;
}

.tree-panel {
  flex: 1;
  max-height: 500px;
  overflow-y: auto;
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 12px;
  background: #fafafa;
}

.form-panel {
  width: 260px;
  padding: 16px;
  border: 1px solid #ccc;
  border-radius: 6px;
  background: #f0f4ff;
}

.form-panel h4 {
  margin-bottom: 8px;
  font-size: 16px;
  color: #1a237e;
}

.form-section {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 8px;
}

mat-form-field {
  width: 100%;
}

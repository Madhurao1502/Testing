private getAssignedToDisplay(row: any): string {
  if (!row.FirstName || !row.LastName) {
    return 'NOT ASSIGNED';
  }

  const hasCommaInFirst = row.FirstName.includes(',');
  const hasCommaInLast = row.LastName.includes(',');

  // Case 1: Not comma separated (just a single name)
  if (!hasCommaInFirst && !hasCommaInLast) {
    return `${row.FirstName.trim()} ${row.LastName.trim()}`.trim();
  }

  // Case 2: Comma separated names
  const firstNames = row.FirstName.split(',').map(name => name.trim());
  const lastNames = row.LastName.split(',').map(name => name.trim());

  if (firstNames.length !== lastNames.length) {
    console.warn('Mismatch between first names and last names count');
    return `${row.FirstName} ${row.LastName}`.trim();
  }

  // Create full names
  const fullNames = firstNames.map((firstName, index) => {
    const lastName = lastNames[index] || '';
    return `${firstName} ${lastName}`.trim();
  });

  return fullNames.join(', ');
}
